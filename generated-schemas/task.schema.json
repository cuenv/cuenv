{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "TaskDefinition",
  "description": "A task definition can be either a single task or a group of tasks",
  "anyOf": [
    {
      "description": "A single task",
      "$ref": "#/$defs/Task"
    },
    {
      "description": "A group of tasks",
      "$ref": "#/$defs/TaskGroup"
    }
  ],
  "$defs": {
    "Shell": {
      "description": "Shell configuration for task execution",
      "type": "object",
      "properties": {
        "command": {
          "description": "Shell executable name (e.g., \"bash\", \"fish\", \"zsh\")",
          "type": ["string", "null"]
        },
        "flag": {
          "description": "Flag for command execution (e.g., \"-c\", \"--command\")",
          "type": ["string", "null"]
        }
      }
    },
    "Task": {
      "description": "A single executable task",
      "type": "object",
      "properties": {
        "args": {
          "description": "Arguments for the command",
          "type": "array",
          "default": [],
          "items": {
            "type": "string"
          }
        },
        "command": {
          "description": "Command to execute",
          "type": "string"
        },
        "dependencies": {
          "description": "Task dependencies (names of tasks that must run first)",
          "type": "array",
          "default": [],
          "items": {
            "type": "string"
          }
        },
        "description": {
          "description": "Description of the task",
          "type": ["string", "null"],
          "default": null
        },
        "inputs": {
          "description": "Input files/resources",
          "type": "array",
          "default": [],
          "items": {
            "type": "string"
          }
        },
        "outputs": {
          "description": "Output files/resources",
          "type": "array",
          "default": [],
          "items": {
            "type": "string"
          }
        },
        "shell": {
          "description": "Shell configuration for command execution (optional)",
          "anyOf": [
            {
              "$ref": "#/$defs/Shell"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        }
      },
      "required": ["command"]
    },
    "TaskGroup": {
      "description": "Represents a group of tasks with execution mode",
      "anyOf": [
        {
          "description": "Sequential execution: array of tasks executed in order",
          "type": "array",
          "items": {
            "$ref": "#"
          }
        },
        {
          "description": "Parallel execution: named tasks that can run concurrently",
          "type": "object",
          "additionalProperties": {
            "$ref": "#"
          }
        }
      ]
    }
  }
}
